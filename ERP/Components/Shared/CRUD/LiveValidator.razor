@using Microsoft.AspNetCore.Components.Forms

@code {
    [CascadingParameter] public EditContext? CurrentEditContext { get; set; }

    protected override void OnInitialized()
    {
        if (CurrentEditContext != null)
        {
            CurrentEditContext.OnFieldChanged += HandleFieldChanged;
        }
    }

    private void HandleFieldChanged(object? sender, FieldChangedEventArgs e)
    {
        // Re-validate the specific field that changed
        // This ensures validation messages appear/disappear immediately
        CurrentEditContext?.Validate();
    }

    public void Dispose()
    {
        if (CurrentEditContext != null)
        {
            CurrentEditContext.OnFieldChanged -= HandleFieldChanged;
        }
    }
}
